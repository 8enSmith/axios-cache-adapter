{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///superapi-cache.min.js","webpack:///webpack/bootstrap ef98fba1ef1b06f7a39a","webpack:///./lib/index.js","webpack:///./lib/read-cache.js","webpack:///./lib/hydrate.js","webpack:///./lib/serialize.js","webpack:///./lib/memory.js","webpack:///./lib/exclude.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","cache","config","arguments","length","undefined","store","_memory2","key","maxAge","readCache","_readCache2","serialize","_serialize2","clearOnStale","exclude","query","paths","filter","log","console","bind","req","next","service","_exclude2","uuid","method","toLowerCase","removeItem","f","then","res","type","status","indexOf","responseType","expiration","Date","now","serviceExpiration","use","setItem","expires","data","getItem","value","err","reason","Object","defineProperty","_readCache","_serialize","_memory","_exclude","url","Promise","resolve","reject","error","Error","message","xhr","_hydrate2","callback","emit","_hydrate","trim","s","replace","parseHeaders","str","lines","split","fields","index","line","field","val","pop","i","len","slice","hydrate","body","headers","getAllResponseHeaders","getResponseHeader","header","responseText","statusText","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","protoProps","staticProps","prototype","MemoryStore","_store","exclusions","match","found","forEach","regexp"],"mappings":"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","file":"superapi-cache.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"superapi-cache\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"superapi-cache\"] = factory();\n\telse\n\t\troot[\"superapi-cache\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"superapi-cache\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"superapi-cache\"] = factory();\n\telse\n\t\troot[\"superapi-cache\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _readCache = __webpack_require__(1);\n\t\n\tvar _readCache2 = _interopRequireDefault(_readCache);\n\t\n\tvar _serialize = __webpack_require__(3);\n\t\n\tvar _serialize2 = _interopRequireDefault(_serialize);\n\t\n\tvar _memory = __webpack_require__(4);\n\t\n\tvar _memory2 = _interopRequireDefault(_memory);\n\t\n\tvar _exclude = __webpack_require__(5);\n\t\n\tvar _exclude2 = _interopRequireDefault(_exclude);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction cache() {\n\t  var config = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\t\n\t  config.store = config.store || _memory2.default;\n\t  var key = config.key || cache.key;\n\t\n\t  config.maxAge = config.maxAge || 0;\n\t  config.readCache = config.readCache || _readCache2.default;\n\t  config.serialize = config.serialize || _serialize2.default;\n\t  config.clearOnStale = config.clearOnStale !== undefined ? config.clearOnStale : true;\n\t\n\t  config.exclude = config.exclude || {};\n\t  config.exclude.query = config.exclude.query || true;\n\t  config.exclude.paths = config.exclude.paths || [];\n\t  config.exclude.filter = null;\n\t\n\t  if (config.log !== false) {\n\t    config.log = typeof config.log === 'function' ? config.log : console.log.bind(console);\n\t  }\n\t\n\t  return function (req, next, service) {\n\t    if ((0, _exclude2.default)(req, service, config.exclude)) {\n\t      return null;\n\t    }\n\t\n\t    var uuid = key(req);\n\t\n\t    // clear cache if method different from GET.\n\t    // We should exclude HEAD\n\t    var method = req.method.toLowerCase();\n\t\n\t    if (method === 'head') {\n\t      return null;\n\t    }\n\t\n\t    if (method !== 'get') {\n\t      config.store.removeItem(uuid);\n\t      return null;\n\t    }\n\t\n\t    var f = function f() {\n\t      return next().then(function (res) {\n\t        var type = res.status / 100 | 0;\n\t\n\t        // only cache 2xx response\n\t        if (type !== 2) {\n\t          return res;\n\t        }\n\t\n\t        // exclude binary response from cache\n\t        if (['arraybuffer', 'blob'].indexOf(res.responseType) >= -1) {\n\t          return res;\n\t        }\n\t\n\t        var expiration = config.maxAge === 0 ? 0 : Date.now() + config.maxAge;\n\t        var serviceExpiration = service.use !== undefined && service.use.cache !== undefined && service.use.cache.expiration !== undefined;\n\t\n\t        if (serviceExpiration) {\n\t          expiration = Date.now() + serviceExpiration;\n\t          config.log('override expiration to use ' + expiration);\n\t        }\n\t\n\t        return config.store.setItem(uuid, {\n\t          expires: expiration,\n\t          data: config.serialize(req, res)\n\t        });\n\t      });\n\t    };\n\t\n\t    return config.store.getItem(uuid).then(function (value) {\n\t      return config.readCache(req, config.log)(value).catch(function (err) {\n\t        // clean up cache if stale\n\t        config.clearOnStale && err.reason === 'cache-stale' ? config.store.removeItem(uuid).then(f) : f();\n\t      });\n\t    });\n\t  };\n\t}\n\t\n\tcache.readCache = _readCache2.default;\n\tcache.serialize = _serialize2.default;\n\t\n\tcache.key = function (req) {\n\t  return req.url;\n\t};\n\t\n\texports.default = cache;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\texports.default = function (req, log) {\n\t  return function (value) {\n\t    return new Promise(function (resolve, reject) {\n\t      if (!value || !value.data) {\n\t        log('cache-miss', req.url);\n\t        var error = new Error();\n\t\n\t        error.reason = 'cache-miss';\n\t        error.message = 'Value not found from cache';\n\t        return reject(error);\n\t      }\n\t\n\t      var expires = value.expires;\n\t      var data = value.data;\n\t\n\t      if (expires !== 0 && expires < Date.now()) {\n\t        log('cache-stale', req.url);\n\t        var error = new Error();\n\t\n\t        error.reason = 'cache-stale';\n\t        error.message = 'Value is stale';\n\t        return reject(error);\n\t      }\n\t\n\t      // hydrate pseudo xhr from cached value\n\t      req.xhr = (0, _hydrate2.default)(data);\n\t\n\t      // override request end callback\n\t      req.callback = function (err, res) {\n\t        log('cache-hit', req.url);\n\t\n\t        if (err) {\n\t          return reject(err, res);\n\t        }\n\t\n\t        resolve(res);\n\t      };\n\t\n\t      req.emit('end');\n\t    });\n\t  };\n\t};\n\t\n\tvar _hydrate = __webpack_require__(2);\n\n\tvar _hydrate2 = _interopRequireDefault(_hydrate);\n\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = hydrate;\n\t/**\n\tvalue should have the following format\n\t{\n\t  body: {\n\t    responseType: '',\n\t    responseText: value,\n\t    status: '',\n\t    statusText: ''\n\t  },\n\t  headers: ''\n\t}\n\t*/\n\t\n\t// borrow from superagent\n\tfunction trim() {\n\t  var s = arguments.length <= 0 || arguments[0] === undefined ? '' : arguments[0];\n\t\n\t  return ''.trim ? s.trim(s) : s.replace(/(^\\s*|\\s*$)/g, '');\n\t}\n\t\n\t// borrow from superagent\n\tfunction parseHeaders() {\n\t  var str = arguments.length <= 0 || arguments[0] === undefined ? '' : arguments[0];\n\t\n\t  var lines = str.split(/\\r?\\n/);\n\t  var fields = {};\n\t  var index = undefined;\n\t  var line = undefined;\n\t  var field = undefined;\n\t  var val = undefined;\n\t\n\t  lines.pop(); // trailing CRLF\n\t\n\t  for (var i = 0, len = lines.length; i < len; i += 1) {\n\t    line = lines[i];\n\t    index = line.indexOf(':');\n\t    field = line.slice(0, index).toLowerCase();\n\t    val = trim(line.slice(index + 1));\n\t    fields[field] = val;\n\t  }\n\t\n\t  return fields;\n\t}\n\t\n\tfunction hydrate(value) {\n\t  var xhr = value.body || {};\n\t  var headers = parseHeaders(value.headers);\n\t\n\t  xhr.getAllResponseHeaders = function () {\n\t    return value.headers;\n\t  };\n\t\n\t  xhr.getResponseHeader = function (header) {\n\t    return headers[header];\n\t  };\n\t\n\t  return xhr;\n\t}\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = serialize;\n\tfunction serialize(req, res) {\n\t  return {\n\t    headers: res.xhr.getAllResponseHeaders(),\n\t    body: {\n\t      responseType: res.xhr.responseType,\n\t      responseText: res.xhr.responseText,\n\t      status: res.status,\n\t      statusText: res.statusText\n\t    }\n\t  };\n\t}\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 4 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar MemoryStore = function () {\n\t  function MemoryStore() {\n\t    _classCallCheck(this, MemoryStore);\n\t\n\t    this._store = {};\n\t  }\n\t\n\t  _createClass(MemoryStore, [{\n\t    key: \"getItem\",\n\t    value: function getItem(key) {\n\t      return Promise.resolve(this._store[key] || null);\n\t    }\n\t  }, {\n\t    key: \"setItem\",\n\t    value: function setItem(key, value) {\n\t      this._store[key] = value;\n\t      return Promise.resolve(value);\n\t    }\n\t  }, {\n\t    key: \"clear\",\n\t    value: function clear() {\n\t      this._store = {};\n\t      return Promise.resolve();\n\t    }\n\t  }]);\n\t\n\t  return MemoryStore;\n\t}();\n\t\n\texports.default = MemoryStore;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = exclude;\n\tfunction exclude(req, service) {\n\t  var exclusions = arguments.length <= 2 || arguments[2] === undefined ? {} : arguments[2];\n\t\n\t  if (service) {\n\t    if (service.use && service.use.cache === false) {\n\t      return true;\n\t    }\n\t  }\n\t\n\t  if (typeof exclusions.filter === 'function' && !exclusions.filter(req)) {\n\t    return true;\n\t  }\n\t\n\t  // do not cache request with query\n\t  if (exclusions.query && req.url.match(/\\?.*$/)) {\n\t    return true;\n\t  }\n\t\n\t  var found = false;\n\t  var paths = exclusions.paths || [];\n\t\n\t  paths.forEach(function (regexp) {\n\t    if (req.url.match(regexp)) {\n\t      found = true;\n\t      return found;\n\t    }\n\t  });\n\t\n\t  if (found) {\n\t    return true;\n\t  }\n\t\n\t  // All rules explained. fo not rewrite regexp.\n\t  return false;\n\t}\n\tmodule.exports = exports['default'];\n\n/***/ }\n/******/ ])\n});\n;\n\n\n/** WEBPACK FOOTER **\n ** superapi-cache.min.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap ef98fba1ef1b06f7a39a\n **/","'use strict'\n\nimport readCache from './read-cache'\nimport serialize from './serialize'\nimport memoryStore from './memory'\nimport exclude from './exclude'\n\nfunction cache (config = {}) {\n  config.store = config.store || memoryStore\n  const key = config.key || cache.key\n\n  config.maxAge = config.maxAge || 0\n  config.readCache = config.readCache || readCache\n  config.serialize = config.serialize || serialize\n  config.clearOnStale = config.clearOnStale !== undefined ? config.clearOnStale : true\n\n  config.exclude = config.exclude || {}\n  config.exclude.query = config.exclude.query || true\n  config.exclude.paths = config.exclude.paths || []\n  config.exclude.filter = null\n\n  if (config.log !== false) {\n    config.log = typeof config.log === 'function' ? config.log : console.log.bind(console)\n  }\n\n  return (req, next, service) => {\n    if (exclude(req, service, config.exclude)) {\n      return null\n    }\n\n    const uuid = key(req)\n\n    // clear cache if method different from GET.\n    // We should exclude HEAD\n    const method = req.method.toLowerCase()\n\n    if (method === 'head') {\n      return null\n    }\n\n    if (method !== 'get') {\n      config.store.removeItem(uuid)\n      return null\n    }\n\n    const f = () => {\n      return next()\n        .then(res => {\n          const type = res.status / 100 | 0\n\n          // only cache 2xx response\n          if (type !== 2) {\n            return res\n          }\n\n          // exclude binary response from cache\n          if (['arraybuffer', 'blob'].indexOf(res.responseType) >= -1) {\n            return res\n          }\n\n          let expiration = config.maxAge === 0 ? 0 : Date.now() + config.maxAge\n          const serviceExpiration =\n            service.use !== undefined &&\n            service.use.cache !== undefined &&\n            service.use.cache.expiration !== undefined\n\n          if (serviceExpiration) {\n            expiration = Date.now() + serviceExpiration\n            config.log('override expiration to use ' + expiration)\n          }\n\n          return config.store.setItem(uuid, {\n            expires: expiration,\n            data: config.serialize(req, res)\n          })\n        })\n    }\n\n    return config.store.getItem(uuid).then(value => {\n      return config.readCache(req, config.log)(value)\n        .catch(err => {\n          // clean up cache if stale\n          config.clearOnStale && err.reason === 'cache-stale' ? config.store.removeItem(uuid).then(f) : f()\n        })\n    })\n  }\n}\n\ncache.readCache = readCache\ncache.serialize = serialize\n\ncache.key = function (req) {\n  return req.url\n}\n\nexport default cache\n\n\n\n/** WEBPACK FOOTER **\n ** ./lib/index.js\n **/","import hydrate from './hydrate'\n\nexport default function (req, log) {\n  return function (value) {\n    return new Promise((resolve, reject) => {\n      if (!value || !value.data) {\n        log('cache-miss', req.url)\n        const error = new Error()\n\n        error.reason = 'cache-miss'\n        error.message = 'Value not found from cache'\n        return reject(error)\n      }\n\n      const { expires, data } = value\n\n      if (expires !== 0 && (expires < Date.now())) {\n        log('cache-stale', req.url)\n        const error = new Error()\n\n        error.reason = 'cache-stale'\n        error.message = 'Value is stale'\n        return reject(error)\n      }\n\n      // hydrate pseudo xhr from cached value\n      req.xhr = hydrate(data)\n\n      // override request end callback\n      req.callback = (err, res) => {\n        log('cache-hit', req.url)\n\n        if (err) {\n          return reject(err, res)\n        }\n\n        resolve(res)\n      }\n\n      req.emit('end')\n    })\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./lib/read-cache.js\n **/","/**\nvalue should have the following format\n{\n  body: {\n    responseType: '',\n    responseText: value,\n    status: '',\n    statusText: ''\n  },\n  headers: ''\n}\n*/\n\n// borrow from superagent\nfunction trim (s = '') {\n  return ''.trim ? s.trim(s) : s.replace(/(^\\s*|\\s*$)/g, '')\n}\n\n// borrow from superagent\nfunction parseHeaders (str = '') {\n  const lines = str.split(/\\r?\\n/)\n  let fields = {}\n  let index\n  let line\n  let field\n  let val\n\n  lines.pop() // trailing CRLF\n\n  for (let i = 0, len = lines.length; i < len; i += 1) {\n    line = lines[i]\n    index = line.indexOf(':')\n    field = line.slice(0, index).toLowerCase()\n    val = trim(line.slice(index + 1))\n    fields[field] = val\n  }\n\n  return fields\n}\n\nexport default function hydrate (value) {\n  const xhr = value.body || {}\n  const headers = parseHeaders(value.headers)\n\n  xhr.getAllResponseHeaders = function () {\n    return value.headers\n  }\n\n  xhr.getResponseHeader = function (header) {\n    return headers[header]\n  }\n\n  return xhr\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./lib/hydrate.js\n **/","export default function serialize (req, res) {\n  return {\n    headers: res.xhr.getAllResponseHeaders(),\n    body: {\n      responseType: res.xhr.responseType,\n      responseText: res.xhr.responseText,\n      status: res.status,\n      statusText: res.statusText\n    }\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./lib/serialize.js\n **/","class MemoryStore {\n  constructor () {\n    this._store = {}\n  }\n\n  getItem (key) {\n    return Promise.resolve(this._store[key] || null)\n  }\n\n  setItem (key, value) {\n    this._store[key] = value\n    return Promise.resolve(value)\n  }\n\n  clear () {\n    this._store = {}\n    return Promise.resolve()\n  }\n}\n\nexport default MemoryStore\n\n\n\n/** WEBPACK FOOTER **\n ** ./lib/memory.js\n **/","\nexport default function exclude (req, service, exclusions = {}) {\n  if (service) {\n    if (service.use && service.use.cache === false) {\n      return true\n    }\n  }\n\n  if ((typeof exclusions.filter === 'function') && !exclusions.filter(req)) {\n    return true\n  }\n\n  // do not cache request with query\n  if (exclusions.query && req.url.match(/\\?.*$/)) {\n    return true\n  }\n\n  let found = false\n  const paths = exclusions.paths || []\n\n  paths.forEach(regexp => {\n    if (req.url.match(regexp)) {\n      found = true\n      return found\n    }\n  })\n\n  if (found) {\n    return true\n  }\n\n  // All rules explained. fo not rewrite regexp.\n  return false\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./lib/exclude.js\n **/"],"sourceRoot":""}